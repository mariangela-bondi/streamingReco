#include "FTCalHitEneCorr_factory.h"
#include "FTCalHit.h"
#include "FTCalHitEneCorr.h"
#include "JANA/JEvent.h"

#include "DAQ/faWaveboardHit.h"
#include "DAQ/fa250VTPMode7Hit.h"

#include "JANA/Services/JParameterManager.h"
#include "JANA/Calibrations/JCalibration.h"
#include "JANA/Calibrations/JCalibrationManager.h"

FTCalHitEneCorr_factory::FTCalHitEneCorr_factory() {
	// TODO Auto-generated constructor stub
	m_tt = 0;

	//These parameters are hard-coded in java recon
	// GEOMETRY PARAMETERS
	CRYS_DELTA = 11.5;
	CRYS_WIDTH = 15.3;													  // crystal width in mm
	CRYS_LENGTH = 200.;													  // crystal length in mm
//	CRYS_ZPOS = 1898.;
	CRYS_ZPOS = 1923.; //Test 21 cm

	/*
	 File generated by code makeGainFiles (author: Andrea Celentano) on: 2020-03-11.17:04:14
	 Gain file used: FTCalCosmic_31975_31976_5deg_08-22-2018_08.53.29_AMcorrected.txt
	 SCALE: 1.2
	 */

//	Time Walk Correction
	//FORMA ARRAY: tw[component][parameter]; array a 4 colonne.
	tw[0][0] = 0;
	tw[0][1] = 0;
	tw[0][2] = 0;
	tw[0][3] = 0;

	tw[1][0] = 0;
	tw[1][1] = 0;
	tw[1][2] = 0;
	tw[1][3] = 0;

	tw[2][0] = 0;
	tw[2][1] = 0;
	tw[2][2] = 0;
	tw[2][3] = 0;

	tw[3][0] = 0;
	tw[3][1] = 0;
	tw[3][2] = 0;
	tw[3][3] = 0;

	tw[4][0] = 0;
	tw[4][1] = 0;
	tw[4][2] = 0;
	tw[4][3] = 0;

	tw[5][0] = 0;
	tw[5][1] = 0;
	tw[5][2] = 0;
	tw[5][3] = 0;

	tw[6][0] = 0;
	tw[6][1] = 0;
	tw[6][2] = 0;
	tw[6][3] = 0;

	tw[7][0] = 0;
	tw[7][1] = 0;
	tw[7][2] = 0;
	tw[7][3] = 0;

	tw[8][0] = -119.803;
	tw[8][1] = 5.35627;
	tw[8][2] = -1.0838;
	tw[8][3] = -0.487021;

	tw[9][0] = -107.638;
	tw[9][1] = 5.91974;
	tw[9][2] = -1.0961;
	tw[9][3] = -1.3776;

	tw[10][0] = -121.082;
	tw[10][1] = 5.41665;
	tw[10][2] = -1.0606;
	tw[10][3] = -1.64228;

	tw[11][0] = -118.864;
	tw[11][1] = 4.03952;
	tw[11][2] = -1.1242;
	tw[11][3] = -2.15105;

	tw[12][0] = -118.942;
	tw[12][1] = 4.6299;
	tw[12][2] = -1.09711;
	tw[12][3] = -1.53868;

	tw[13][0] = -121.086;
	tw[13][1] = 5.07953;
	tw[13][2] = -1.05524;
	tw[13][3] = -0.936852;

	tw[14][0] = 0;
	tw[14][1] = 0;
	tw[14][2] = 0;
	tw[14][3] = 0;

	tw[15][0] = 0;
	tw[15][1] = 0;
	tw[15][2] = 0;
	tw[15][3] = 0;

	tw[16][0] = 0;
	tw[16][1] = 0;
	tw[16][2] = 0;
	tw[16][3] = 0;

	tw[17][0] = 0;
	tw[17][1] = 0;
	tw[17][2] = 0;
	tw[17][3] = 0;

	tw[18][0] = 0;
	tw[18][1] = 0;
	tw[18][2] = 0;
	tw[18][3] = 0;

	tw[19][0] = 0;
	tw[19][1] = 0;
	tw[19][2] = 0;
	tw[19][3] = 0;

	tw[20][0] = 0;
	tw[20][1] = 0;
	tw[20][2] = 0;
	tw[20][3] = 0;

	tw[21][0] = 0;
	tw[21][1] = 0;
	tw[21][2] = 0;
	tw[21][3] = 0;

	tw[22][0] = 0;
	tw[22][1] = 0;
	tw[22][2] = 0;
	tw[22][3] = 0;

	tw[23][0] = 0;
	tw[23][1] = 0;
	tw[23][2] = 0;
	tw[23][3] = 0;

	tw[24][0] = 0;
	tw[24][1] = 0;
	tw[24][2] = 0;
	tw[24][3] = 0;

	tw[25][0] = 0;
	tw[25][1] = 0;
	tw[25][2] = 0;
	tw[25][3] = 0;

	tw[26][0] = 0;
	tw[26][1] = 0;
	tw[26][2] = 0;
	tw[26][3] = 0;

	tw[27][0] = -112.263;
	tw[27][1] = 6.29338;
	tw[27][2] = -1.05673;
	tw[27][3] = -0.588365;

	tw[28][0] = -99.6814;
	tw[28][1] = 5.36741;
	tw[28][2] = -1.12064;
	tw[28][3] = -2.16577;

	tw[29][0] = -135.02;
	tw[29][1] = 8.00655;
	tw[29][2] = -1.14574;
	tw[29][3] = -0.806387;

	tw[30][0] = -153.976;
	tw[30][1] = 5.14462;
	tw[30][2] = -1.32827;
	tw[30][3] = -1.4211;

	tw[31][0] = -126.448;
	tw[31][1] = 7.07097;
	tw[31][2] = -1.37602;
	tw[31][3] = -0.727536;

	tw[32][0] = -163.524;
	tw[32][1] = 4.80765;
	tw[32][2] = -1.38937;
	tw[32][3] = -1.02717;

	tw[33][0] = -173.909;
	tw[33][1] = 4.71081;
	tw[33][2] = -1.34787;
	tw[33][3] = -2.28289;

	tw[34][0] = -160.85;
	tw[34][1] = 4.64062;
	tw[34][2] = -1.38973;
	tw[34][3] = -1.40141;

	tw[35][0] = -170.604;
	tw[35][1] = 4.32942;
	tw[35][2] = -1.34098;
	tw[35][3] = -1.5624;

	tw[36][0] = -155.227;
	tw[36][1] = 3.59228;
	tw[36][2] = -1.39974;
	tw[36][3] = -1.19088;

	tw[37][0] = -201.163;
	tw[37][1] = 0.545357;
	tw[37][2] = -1.30437;
	tw[37][3] = -3.74099;

	tw[38][0] = -169.474;
	tw[38][1] = 3.6397;
	tw[38][2] = -1.51282;
	tw[38][3] = -1.54452;

	tw[39][0] = 0;
	tw[39][1] = 0;
	tw[39][2] = 0;
	tw[39][3] = 0;

	tw[40][0] = 0;
	tw[40][1] = 0;
	tw[40][2] = 0;
	tw[40][3] = 0;

	tw[41][0] = 0;
	tw[41][1] = 0;
	tw[41][2] = 0;
	tw[41][3] = 0;

	tw[42][0] = 0;
	tw[42][1] = 0;
	tw[42][2] = 0;
	tw[42][3] = 0;

	tw[43][0] = 0;
	tw[43][1] = 0;
	tw[43][2] = 0;
	tw[43][3] = 0;

	tw[44][0] = 0;
	tw[44][1] = 0;
	tw[44][2] = 0;
	tw[44][3] = 0;

	tw[45][0] = 0;
	tw[45][1] = 0;
	tw[45][2] = 0;
	tw[45][3] = 0;

	tw[46][0] = 0;
	tw[46][1] = 0;
	tw[46][2] = 0;
	tw[46][3] = 0;

	tw[47][0] = 0;
	tw[47][1] = 0;
	tw[47][2] = 0;
	tw[47][3] = 0;

	tw[48][0] = -181.369;
	tw[48][1] = 7.77936;
	tw[48][2] = -1.5157;
	tw[48][3] = -1.10409;

	tw[49][0] = -170.723;
	tw[49][1] = 6.1527;
	tw[49][2] = -1.57568;
	tw[49][3] = -1.99968;

	tw[50][0] = 0;
	tw[50][1] = 0;
	tw[50][2] = 0;
	tw[50][3] = 0;

	tw[51][0] = 0;
	tw[51][1] = 0;
	tw[51][2] = 0;
	tw[51][3] = 0;

	tw[52][0] = -154.547;
	tw[52][1] = 7.43314;
	tw[52][2] = -1.6095;
	tw[52][3] = -0.472448;

	tw[53][0] = -150.687;
	tw[53][1] = 7.93993;
	tw[53][2] = -1.60637;
	tw[53][3] = -1.71801;

	tw[54][0] = -166.064;
	tw[54][1] = 7.04136;
	tw[54][2] = -1.57523;
	tw[54][3] = -1.09145;

	tw[55][0] = -203.924;
	tw[55][1] = 3.86994;
	tw[55][2] = -1.59513;
	tw[55][3] = -2.11933;

	tw[56][0] = -197.492;
	tw[56][1] = 3.85649;
	tw[56][2] = -1.62051;
	tw[56][3] = -1.85551;

	tw[57][0] = -172.328;
	tw[57][1] = 6.5407;
	tw[57][2] = -1.71751;
	tw[57][3] = -1.09029;

	tw[58][0] = -195.171;
	tw[58][1] = 5.01224;
	tw[58][2] = -1.63008;
	tw[58][3] = -1.42483;

	tw[59][0] = -199.564;
	tw[59][1] = 3.72387;
	tw[59][2] = -1.66291;
	tw[59][3] = -3.09168;

	tw[60][0] = -190.436;
	tw[60][1] = 7.83968;
	tw[60][2] = -1.41408;
	tw[60][3] = -0.272583;

	tw[61][0] = -155.918;
	tw[61][1] = 4.86033;
	tw[61][2] = -1.58255;
	tw[61][3] = -2.39893;

	tw[62][0] = 0;
	tw[62][1] = 0;
	tw[62][2] = 0;
	tw[62][3] = 0;

	tw[63][0] = 0;
	tw[63][1] = 0;
	tw[63][2] = 0;
	tw[63][3] = 0;

	tw[64][0] = 0;
	tw[64][1] = 0;
	tw[64][2] = 0;
	tw[64][3] = 0;

	tw[65][0] = 0;
	tw[65][1] = 0;
	tw[65][2] = 0;
	tw[65][3] = 0;

	tw[66][0] = 0;
	tw[66][1] = 0;
	tw[66][2] = 0;
	tw[66][3] = 0;

	tw[67][0] = 0;
	tw[67][1] = 0;
	tw[67][2] = 0;
	tw[67][3] = 0;

	tw[68][0] = 0;
	tw[68][1] = 0;
	tw[68][2] = 0;
	tw[68][3] = 0;

	tw[69][0] = -154.412;
	tw[69][1] = 4.80949;
	tw[69][2] = -1.29977;
	tw[69][3] = -2.00456;

	tw[70][0] = -148.508;
	tw[70][1] = 7.04008;
	tw[70][2] = -1.24449;
	tw[70][3] = -0.779035;

	tw[71][0] = -153.986;
	tw[71][1] = 5.00454;
	tw[71][2] = -1.31103;
	tw[71][3] = -1.96441;

	tw[72][0] = -137.691;
	tw[72][1] = 5.29783;
	tw[72][2] = -1.34891;
	tw[72][3] = -1.6834;

	tw[73][0] = -121.557;
	tw[73][1] = 5.93407;
	tw[73][2] = -1.05555;
	tw[73][3] = -0.853081;

	tw[74][0] = -134.079;
	tw[74][1] = 4.5674;
	tw[74][2] = -1.09571;
	tw[74][3] = -1.99101;

	tw[75][0] = -118.162;
	tw[75][1] = 6.54702;
	tw[75][2] = -1.12287;
	tw[75][3] = -1.26968;

	tw[76][0] = -140.755;
	tw[76][1] = 5.02489;
	tw[76][2] = -1.14856;
	tw[76][3] = -1.30531;

	tw[77][0] = -147.325;
	tw[77][1] = 3.46319;
	tw[77][2] = -1.19655;
	tw[77][3] = -1.76275;

	tw[78][0] = -141.644;
	tw[78][1] = 3.46658;
	tw[78][2] = -1.21794;
	tw[78][3] = -2.39264;

	tw[79][0] = -134.794;
	tw[79][1] = 4.42117;
	tw[79][2] = -1.23669;
	tw[79][3] = -1.04768;

	tw[80][0] = -145.781;
	tw[80][1] = 3.62729;
	tw[80][2] = -1.21879;
	tw[80][3] = -1.32493;

	tw[81][0] = -131.44;
	tw[81][1] = 4.13104;
	tw[81][2] = -1.25537;
	tw[81][3] = -2.18375;

	tw[82][0] = -157.305;
	tw[82][1] = 2.03328;
	tw[82][2] = -1.20091;
	tw[82][3] = -1.61153;

	tw[83][0] = -117.353;
	tw[83][1] = 4.63963;
	tw[83][2] = -1.31692;
	tw[83][3] = -1.50042;

	tw[84][0] = -187.903;
	tw[84][1] = 0.241105;
	tw[84][2] = -1.14222;
	tw[84][3] = -2.69854;

	tw[85][0] = 0;
	tw[85][1] = 0;
	tw[85][2] = 0;
	tw[85][3] = 0;

	tw[86][0] = 0;
	tw[86][1] = 0;
	tw[86][2] = 0;
	tw[86][3] = 0;

	tw[87][0] = 0;
	tw[87][1] = 0;
	tw[87][2] = 0;
	tw[87][3] = 0;

	tw[88][0] = 0;
	tw[88][1] = 0;
	tw[88][2] = 0;
	tw[88][3] = 0;

	tw[89][0] = 0;
	tw[89][1] = 0;
	tw[89][2] = 0;
	tw[89][3] = 0;

	tw[90][0] = -139.802;
	tw[90][1] = 5.58036;
	tw[90][2] = -1.33928;
	tw[90][3] = -2.34145;

	tw[91][0] = -145.475;
	tw[91][1] = 4.96929;
	tw[91][2] = -1.34175;
	tw[91][3] = -0.790737;

	tw[92][0] = -142.713;
	tw[92][1] = 4.84252;
	tw[92][2] = -1.35565;
	tw[92][3] = -1.09457;

	tw[93][0] = -146.377;
	tw[93][1] = 4.78707;
	tw[93][2] = -1.34174;
	tw[93][3] = -1.60323;

	tw[94][0] = -141.921;
	tw[94][1] = 4.92688;
	tw[94][2] = -1.35646;
	tw[94][3] = -1.1768;

	tw[95][0] = -141.227;
	tw[95][1] = 6.14383;
	tw[95][2] = -1.3277;
	tw[95][3] = -2.98308;

	tw[96][0] = -123.669;
	tw[96][1] = 5.71461;
	tw[96][2] = -1.11695;
	tw[96][3] = 1.6236;

	tw[97][0] = -134.903;
	tw[97][1] = 4.3237;
	tw[97][2] = -1.16239;
	tw[97][3] = -3.30743;

	tw[98][0] = -142.934;
	tw[98][1] = 3.59993;
	tw[98][2] = -1.14226;
	tw[98][3] = -0.979446;

	tw[99][0] = -144.117;
	tw[99][1] = 2.61079;
	tw[99][2] = -1.17027;
	tw[99][3] = -2.08859;

	tw[100][0] = -141.606;
	tw[100][1] = 4.48892;
	tw[100][2] = -1.13521;
	tw[100][3] = -1.66133;

	tw[101][0] = -144.484;
	tw[101][1] = 3.02568;
	tw[101][2] = -1.17969;
	tw[101][3] = -0.980712;

	tw[102][0] = -144.023;
	tw[102][1] = 5.08067;
	tw[102][2] = -1.15657;
	tw[102][3] = -1.49193;

	tw[103][0] = -143.566;
	tw[103][1] = 3.99509;
	tw[103][2] = -1.19643;
	tw[103][3] = -2.16452;

	tw[104][0] = -145.822;
	tw[104][1] = 2.66449;
	tw[104][2] = -1.23665;
	tw[104][3] = -1.0909;

	tw[105][0] = -134.23;
	tw[105][1] = 4.31034;
	tw[105][2] = -1.27106;
	tw[105][3] = -3.15336;

	tw[106][0] = -179.447;
	tw[106][1] = 4.61358;
	tw[106][2] = -1.28036;
	tw[106][3] = -0.829391;

	tw[107][0] = -170.345;
	tw[107][1] = 2.89759;
	tw[107][2] = -1.35774;
	tw[107][3] = -2.64719;

	tw[108][0] = 0;
	tw[108][1] = 0;
	tw[108][2] = 0;
	tw[108][3] = 0;

	tw[109][0] = 0;
	tw[109][1] = 0;
	tw[109][2] = 0;
	tw[109][3] = 0;

	tw[110][0] = 0;
	tw[110][1] = 0;
	tw[110][2] = 0;
	tw[110][3] = 0;

	tw[111][0] = -135.204;
	tw[111][1] = 5.52216;
	tw[111][2] = -1.47842;
	tw[111][3] = -1.4548;

	tw[112][0] = -128.937;
	tw[112][1] = 6.09687;
	tw[112][2] = -1.48533;
	tw[112][3] = -1.80341;

	tw[113][0] = -130.684;
	tw[113][1] = 6.11808;
	tw[113][2] = -1.38952;
	tw[113][3] = -0.616412;

	tw[114][0] = -152.018;
	tw[114][1] = 4.55233;
	tw[114][2] = -1.39178;
	tw[114][3] = -1.95289;

	tw[115][0] = -151.104;
	tw[115][1] = 4.40244;
	tw[115][2] = -1.40034;
	tw[115][3] = -1.66831;

	tw[116][0] = -152.134;
	tw[116][1] = 5.51919;
	tw[116][2] = -1.36174;
	tw[116][3] = -2.05436;

	tw[117][0] = -135.676;
	tw[117][1] = 6.49451;
	tw[117][2] = -1.10673;
	tw[117][3] = -1.16111;

	tw[118][0] = -150.909;
	tw[118][1] = 4.70395;
	tw[118][2] = -1.16498;
	tw[118][3] = -2.1874;

	tw[119][0] = -134.14;
	tw[119][1] = 7.17838;
	tw[119][2] = -1.19922;
	tw[119][3] = -1.41533;

	tw[120][0] = -167.829;
	tw[120][1] = 4.23705;
	tw[120][2] = -1.29883;
	tw[120][3] = -0.988924;

	tw[121][0] = -142.63;
	tw[121][1] = 5.30546;
	tw[121][2] = -1.34853;
	tw[121][3] = -1.12825;

	tw[122][0] = -149.022;
	tw[122][1] = 5.44858;
	tw[122][2] = -1.32263;
	tw[122][3] = -2.47736;

	tw[123][0] = -143.181;
	tw[123][1] = 5.37591;
	tw[123][2] = -1.34715;
	tw[123][3] = -1.5491;

	tw[124][0] = -155.51;
	tw[124][1] = 4.74062;
	tw[124][2] = -1.25288;
	tw[124][3] = -1.19815;

	tw[125][0] = -149.416;
	tw[125][1] = 5.12673;
	tw[125][2] = -1.26568;
	tw[125][3] = -1.74557;

	tw[126][0] = -172.717;
	tw[126][1] = 2.33471;
	tw[126][2] = -1.33189;
	tw[126][3] = -1.99554;

	tw[127][0] = -156.516;
	tw[127][1] = 4.65983;
	tw[127][2] = -1.39723;
	tw[127][3] = -2.06753;

	tw[128][0] = -174.946;
	tw[128][1] = 2.75245;
	tw[128][2] = -1.38494;
	tw[128][3] = -1.10952;

	tw[129][0] = -148.239;
	tw[129][1] = 4.63759;
	tw[129][2] = -1.44895;
	tw[129][3] = -2.07058;

	tw[130][0] = -148.766;
	tw[130][1] = 4.65463;
	tw[130][2] = -1.43813;
	tw[130][3] = -0.536549;

	tw[131][0] = 0;
	tw[131][1] = 0;
	tw[131][2] = 0;
	tw[131][3] = 0;

	tw[132][0] = 0;
	tw[132][1] = 0;
	tw[132][2] = 0;
	tw[132][3] = 0;

	tw[133][0] = -152.547;
	tw[133][1] = 6.31507;
	tw[133][2] = -1.38367;
	tw[133][3] = -1.64027;

	tw[134][0] = -154.532;
	tw[134][1] = 5.50969;
	tw[134][2] = -1.40576;
	tw[134][3] = -1.90614;

	tw[135][0] = -141.633;
	tw[135][1] = 5.16893;
	tw[135][2] = -1.08849;
	tw[135][3] = -1.10927;

	tw[136][0] = -120.69;
	tw[136][1] = 4.64658;
	tw[136][2] = -1.14554;
	tw[136][3] = -0.208333;

	tw[137][0] = -121.381;
	tw[137][1] = 4.55644;
	tw[137][2] = -1.1514;
	tw[137][3] = -2.0535;

	tw[138][0] = -128.316;
	tw[138][1] = 4.60524;
	tw[138][2] = -1.00039;
	tw[138][3] = -2.2755;

	tw[139][0] = -117.16;
	tw[139][1] = 5.4772;
	tw[139][2] = -1.01902;
	tw[139][3] = -1.00848;

	tw[140][0] = -114.871;
	tw[140][1] = 4.71274;
	tw[140][2] = -1.05658;
	tw[140][3] = -1.48354;

	tw[141][0] = -93.1516;
	tw[141][1] = 5.16525;
	tw[141][2] = -1.10489;
	tw[141][3] = 0.271584;

	tw[142][0] = -113.425;
	tw[142][1] = 4.16356;
	tw[142][2] = -1.01837;
	tw[142][3] = 0.498442;

	tw[143][0] = -73.541;
	tw[143][1] = 5.42115;
	tw[143][2] = -1.08354;
	tw[143][3] = 2.50016;

	tw[144][0] = -83.4071;
	tw[144][1] = 4.61039;
	tw[144][2] = -1.09853;
	tw[144][3] = -0.255053;

	tw[145][0] = 0;
	tw[145][1] = 0;
	tw[145][2] = 0;
	tw[145][3] = 0;

	tw[146][0] = -114.258;
	tw[146][1] = 3.15933;
	tw[146][2] = -0.940823;
	tw[146][3] = -2.08203;

	tw[147][0] = -107.783;
	tw[147][1] = 3.14579;
	tw[147][2] = -0.966956;
	tw[147][3] = -1.58216;

	tw[148][0] = -108.511;
	tw[148][1] = 4.26988;
	tw[148][2] = -0.902687;
	tw[148][3] = -0.939223;

	tw[149][0] = -113.139;
	tw[149][1] = 2.61297;
	tw[149][2] = -0.976259;
	tw[149][3] = -2.33976;

	tw[150][0] = -120.215;
	tw[150][1] = 2.29304;
	tw[150][2] = -0.926313;
	tw[150][3] = -1.59271;

	tw[151][0] = -107.278;
	tw[151][1] = 3.38015;
	tw[151][2] = -0.965272;
	tw[151][3] = -1.85343;

	tw[152][0] = -110.658;
	tw[152][1] = 2.76849;
	tw[152][2] = -0.973448;
	tw[152][3] = -1.12188;

	tw[153][0] = 0;
	tw[153][1] = 0;
	tw[153][2] = 0;
	tw[153][3] = 0;

	tw[154][0] = 0;
	tw[154][1] = 0;
	tw[154][2] = 0;
	tw[154][3] = 0;

	tw[155][0] = -102.16;
	tw[155][1] = 3.55945;
	tw[155][2] = -0.994519;
	tw[155][3] = -2.03562;

	tw[156][0] = -94.4577;
	tw[156][1] = 4.20604;
	tw[156][2] = -1.01112;
	tw[156][3] = -1.41302;

	tw[157][0] = -99.2263;
	tw[157][1] = 3.96422;
	tw[157][2] = -1.00236;
	tw[157][3] = -1.1028;

	tw[158][0] = 0;
	tw[158][1] = 0;
	tw[158][2] = 0;
	tw[158][3] = 0;

	tw[159][0] = -122.318;
	tw[159][1] = 3.16562;
	tw[159][2] = -0.922012;
	tw[159][3] = -3.22497;

	tw[160][0] = -116.902;
	tw[160][1] = 3.32832;
	tw[160][2] = -0.944007;
	tw[160][3] = -0.359634;

	tw[161][0] = -111.234;
	tw[161][1] = 4.79036;
	tw[161][2] = -0.945478;
	tw[161][3] = -1.02324;

	tw[162][0] = 0;
	tw[162][1] = 0;
	tw[162][2] = 0;
	tw[162][3] = 0;

	tw[163][0] = 0;
	tw[163][1] = 0;
	tw[163][2] = 0;
	tw[163][3] = 0;

	tw[164][0] = 0;
	tw[164][1] = 0;
	tw[164][2] = 0;
	tw[164][3] = 0;

	tw[165][0] = 0;
	tw[165][1] = 0;
	tw[165][2] = 0;
	tw[165][3] = 0;

	tw[166][0] = 0;
	tw[166][1] = 0;
	tw[166][2] = 0;
	tw[166][3] = 0;

	tw[167][0] = -92.0191;
	tw[167][1] = 4.91349;
	tw[167][2] = -0.974168;
	tw[167][3] = -1.61182;

	tw[168][0] = -115.417;
	tw[168][1] = 3.25391;
	tw[168][2] = -0.962095;
	tw[168][3] = -0.478871;

	tw[169][0] = -122.084;
	tw[169][1] = 2.85541;
	tw[169][2] = -0.964448;
	tw[169][3] = -3.76896;

	tw[170][0] = -115.47;
	tw[170][1] = 4.31425;
	tw[170][2] = -0.978404;
	tw[170][3] = -0.807479;

	tw[171][0] = -122.525;
	tw[171][1] = 2.77608;
	tw[171][2] = -1.03931;
	tw[171][3] = -2.45408;

	tw[172][0] = -120.765;
	tw[172][1] = 2.92542;
	tw[172][2] = -1.04593;
	tw[172][3] = -1.43615;

	tw[173][0] = -123.475;
	tw[173][1] = 3.06203;
	tw[173][2] = -1.02811;
	tw[173][3] = -1.57515;

	tw[174][0] = -118.803;
	tw[174][1] = 3.40583;
	tw[174][2] = -1.04008;
	tw[174][3] = -1.5563;

	tw[175][0] = 0;
	tw[175][1] = 0;
	tw[175][2] = 0;
	tw[175][3] = 0;

	tw[176][0] = -109.169;
	tw[176][1] = 3.35122;
	tw[176][2] = -1.07636;
	tw[176][3] = -1.14607;

	tw[177][0] = -104.026;
	tw[177][1] = 4.13741;
	tw[177][2] = -1.08102;
	tw[177][3] = -1.7495;

	tw[178][0] = -118.888;
	tw[178][1] = 3.31986;
	tw[178][2] = -1.0239;
	tw[178][3] = -1.69517;

	tw[179][0] = -111.296;
	tw[179][1] = 4.30555;
	tw[179][2] = -1.03571;
	tw[179][3] = -1.70885;

	tw[180][0] = -132.715;
	tw[180][1] = 2.89539;
	tw[180][2] = -0.96341;
	tw[180][3] = -0.869056;

	tw[181][0] = -111.968;
	tw[181][1] = 3.95084;
	tw[181][2] = -1.0061;
	tw[181][3] = -2.98514;

	tw[182][0] = -113.135;
	tw[182][1] = 5.81969;
	tw[182][2] = -1.04896;
	tw[182][3] = 1.43962;

	tw[183][0] = -129.868;
	tw[183][1] = 5.94716;
	tw[183][2] = -1.01561;
	tw[183][3] = -3.95161;

	tw[184][0] = 0;
	tw[184][1] = 0;
	tw[184][2] = 0;
	tw[184][3] = 0;

	tw[185][0] = 0;
	tw[185][1] = 0;
	tw[185][2] = 0;
	tw[185][3] = 0;

	tw[186][0] = 0;
	tw[186][1] = 0;
	tw[186][2] = 0;
	tw[186][3] = 0;

	tw[187][0] = 0;
	tw[187][1] = 0;
	tw[187][2] = 0;
	tw[187][3] = 0;

	tw[188][0] = 0;
	tw[188][1] = 0;
	tw[188][2] = 0;
	tw[188][3] = 0;

	tw[189][0] = 0;
	tw[189][1] = 0;
	tw[189][2] = 0;
	tw[189][3] = 0;

	tw[190][0] = -86.7743;
	tw[190][1] = 6.96202;
	tw[190][2] = -1.04971;
	tw[190][3] = 0.832486;

	tw[191][0] = -164.24;
	tw[191][1] = 4.99605;
	tw[191][2] = -1.30894;
	tw[191][3] = 0.757386;

	tw[192][0] = -203.014;
	tw[192][1] = 2.20347;
	tw[192][2] = -1.35206;
	tw[192][3] = -3.40281;

	tw[193][0] = -180.185;
	tw[193][1] = 6.59501;
	tw[193][2] = -1.56188;
	tw[193][3] = -1.24808;

	tw[194][0] = -199.681;
	tw[194][1] = 3.41415;
	tw[194][2] = -1.65451;
	tw[194][3] = -1.84612;

	tw[195][0] = -203.232;
	tw[195][1] = 3.76061;
	tw[195][2] = -1.61985;
	tw[195][3] = -2.02885;

	tw[196][0] = -198.375;
	tw[196][1] = 3.52147;
	tw[196][2] = -1.64357;
	tw[196][3] = -1.78966;

	tw[197][0] = -167.338;
	tw[197][1] = 6.1917;
	tw[197][2] = -1.39588;
	tw[197][3] = -0.971047;

	tw[198][0] = -141.332;
	tw[198][1] = 6.21882;
	tw[198][2] = -1.44902;
	tw[198][3] = -0.650169;

	tw[199][0] = -151.168;
	tw[199][1] = 5.05554;
	tw[199][2] = -1.46895;
	tw[199][3] = -2.21883;

	tw[200][0] = -155.689;
	tw[200][1] = 4.97128;
	tw[200][2] = -1.40603;
	tw[200][3] = -1.34491;

	tw[201][0] = -143.227;
	tw[201][1] = 5.80505;
	tw[201][2] = -1.42508;
	tw[201][3] = -1.74627;

	tw[202][0] = -147.58;
	tw[202][1] = 5.19304;
	tw[202][2] = -1.10599;
	tw[202][3] = -0.372118;

	tw[203][0] = -132.524;
	tw[203][1] = 4.27283;
	tw[203][2] = -1.16705;
	tw[203][3] = -2.05865;

	tw[204][0] = -100.874;
	tw[204][1] = 6.81792;
	tw[204][2] = -1.32095;
	tw[204][3] = 3.22651;

	tw[205][0] = 0;
	tw[205][1] = 0;
	tw[205][2] = 0;
	tw[205][3] = 0;

	tw[206][0] = 0;
	tw[206][1] = 0;
	tw[206][2] = 0;
	tw[206][3] = 0;

	tw[207][0] = 0;
	tw[207][1] = 0;
	tw[207][2] = 0;
	tw[207][3] = 0;

	tw[208][0] = 0;
	tw[208][1] = 0;
	tw[208][2] = 0;
	tw[208][3] = 0;

	tw[209][0] = 0;
	tw[209][1] = 0;
	tw[209][2] = 0;
	tw[209][3] = 0;

	tw[210][0] = 0;
	tw[210][1] = 0;
	tw[210][2] = 0;
	tw[210][3] = 0;

	tw[211][0] = 0;
	tw[211][1] = 0;
	tw[211][2] = 0;
	tw[211][3] = 0;

	tw[212][0] = 0;
	tw[212][1] = 0;
	tw[212][2] = 0;
	tw[212][3] = 0;

	tw[213][0] = -104.385;
	tw[213][1] = 7.78233;
	tw[213][2] = -1.22905;
	tw[213][3] = 2.39544;

	tw[214][0] = -178.751;
	tw[214][1] = 4.54247;
	tw[214][2] = -1.43908;
	tw[214][3] = -1.88989;

	tw[215][0] = -180.995;
	tw[215][1] = 4.08376;
	tw[215][2] = -1.44191;
	tw[215][3] = -2.14645;

	tw[216][0] = -164.816;
	tw[216][1] = 4.13938;
	tw[216][2] = -1.4907;
	tw[216][3] = -1.44935;

	tw[217][0] = -171.231;
	tw[217][1] = 3.92806;
	tw[217][2] = -1.4506;
	tw[217][3] = -1.0049;

	tw[218][0] = -170.394;
	tw[218][1] = 5.77594;
	tw[218][2] = -1.43259;
	tw[218][3] = -1.98613;

	tw[219][0] = -166.892;
	tw[219][1] = 5.10051;
	tw[219][2] = -1.46498;
	tw[219][3] = -0.986587;

	tw[220][0] = -142.908;
	tw[220][1] = 5.70755;
	tw[220][2] = -1.50971;
	tw[220][3] = -1.6336;

	tw[221][0] = -131.524;
	tw[221][1] = 7.27362;
	tw[221][2] = -1.51842;
	tw[221][3] = -1.49277;

	tw[222][0] = -148.176;
	tw[222][1] = 6.09474;
	tw[222][2] = -1.50704;
	tw[222][3] = -1.46786;

	tw[223][0] = -154.932;
	tw[223][1] = 6.26302;
	tw[223][2] = -1.46496;
	tw[223][3] = -1.94673;

	tw[224][0] = -170.378;
	tw[224][1] = 4.89067;
	tw[224][2] = -1.44098;
	tw[224][3] = -0.360965;

	tw[225][0] = -157.61;
	tw[225][1] = 5.6642;
	tw[225][2] = -1.4617;
	tw[225][3] = -1.58715;

	tw[226][0] = -132.236;
	tw[226][1] = 6.28105;
	tw[226][2] = -1.18999;
	tw[226][3] = 1.02169;

	tw[227][0] = 0;
	tw[227][1] = 0;
	tw[227][2] = 0;
	tw[227][3] = 0;

	tw[228][0] = 0;
	tw[228][1] = 0;
	tw[228][2] = 0;
	tw[228][3] = 0;

	tw[229][0] = 0;
	tw[229][1] = 0;
	tw[229][2] = 0;
	tw[229][3] = 0;

	tw[230][0] = 0;
	tw[230][1] = 0;
	tw[230][2] = 0;
	tw[230][3] = 0;

	tw[231][0] = 0;
	tw[231][1] = 0;
	tw[231][2] = 0;
	tw[231][3] = 0;

	tw[232][0] = 0;
	tw[232][1] = 0;
	tw[232][2] = 0;
	tw[232][3] = 0;

	tw[233][0] = 0;
	tw[233][1] = 0;
	tw[233][2] = 0;
	tw[233][3] = 0;

	tw[234][0] = 0;
	tw[234][1] = 0;
	tw[234][2] = 0;
	tw[234][3] = 0;

	tw[235][0] = -110.019;
	tw[235][1] = 7.71123;
	tw[235][2] = -1.21396;
	tw[235][3] = 2.64378;

	tw[236][0] = -161.483;
	tw[236][1] = 5.49991;
	tw[236][2] = -1.31769;
	tw[236][3] = -2.34298;

	tw[237][0] = -175.571;
	tw[237][1] = 3.74149;
	tw[237][2] = -1.33982;
	tw[237][3] = -1.84095;

	tw[238][0] = -153.412;
	tw[238][1] = 3.97125;
	tw[238][2] = -1.39414;
	tw[238][3] = -1.80426;

	tw[239][0] = -159.531;
	tw[239][1] = 3.58783;
	tw[239][2] = -1.35742;
	tw[239][3] = -0.6832;

	tw[240][0] = -167.151;
	tw[240][1] = 2.87929;
	tw[240][2] = -1.35645;
	tw[240][3] = -2.23736;

	tw[241][0] = -158.336;
	tw[241][1] = 3.35134;
	tw[241][2] = -1.39327;
	tw[241][3] = -1.5826;

	tw[242][0] = -145.808;
	tw[242][1] = 5.28207;
	tw[242][2] = -1.44511;
	tw[242][3] = 0.530201;

	tw[243][0] = -159;
	tw[243][1] = 4.83449;
	tw[243][2] = -1.41858;
	tw[243][3] = -1.43603;

	tw[244][0] = -156.481;
	tw[244][1] = 5.46456;
	tw[244][2] = -1.40929;
	tw[244][3] = -0.410271;

	tw[245][0] = -156.28;
	tw[245][1] = 5.31607;
	tw[245][2] = -1.41816;
	tw[245][3] = -1.68744;

	tw[246][0] = -167.268;
	tw[246][1] = 4.87455;
	tw[246][2] = -1.36483;
	tw[246][3] = -1.49479;

	tw[247][0] = -164.587;
	tw[247][1] = 6.14122;
	tw[247][2] = -1.35186;
	tw[247][3] = -1.90658;

	tw[248][0] = -115.115;
	tw[248][1] = 9.51525;
	tw[248][2] = -1.41232;
	tw[248][3] = 2.25988;

	tw[249][0] = 0;
	tw[249][1] = 0;
	tw[249][2] = 0;
	tw[249][3] = 0;

	tw[250][0] = 0;
	tw[250][1] = 0;
	tw[250][2] = 0;
	tw[250][3] = 0;

	tw[251][0] = 0;
	tw[251][1] = 0;
	tw[251][2] = 0;
	tw[251][3] = 0;

	tw[252][0] = 0;
	tw[252][1] = 0;
	tw[252][2] = 0;
	tw[252][3] = 0;

	tw[253][0] = 0;
	tw[253][1] = 0;
	tw[253][2] = 0;
	tw[253][3] = 0;

	tw[254][0] = 0;
	tw[254][1] = 0;
	tw[254][2] = 0;
	tw[254][3] = 0;

	tw[255][0] = 0;
	tw[255][1] = 0;
	tw[255][2] = 0;
	tw[255][3] = 0;

	tw[256][0] = 0;
	tw[256][1] = 0;
	tw[256][2] = 0;
	tw[256][3] = 0;

	tw[257][0] = -161.754;
	tw[257][1] = 6.51723;
	tw[257][2] = -1.37486;
	tw[257][3] = -0.00195115;

	tw[258][0] = -168.913;
	tw[258][1] = 4.05408;
	tw[258][2] = -1.46272;
	tw[258][3] = -1.913;

	tw[259][0] = -198.893;
	tw[259][1] = 5.73565;
	tw[259][2] = -1.46702;
	tw[259][3] = -1.47033;

	tw[260][0] = -168.682;
	tw[260][1] = 4.36228;
	tw[260][2] = -1.54661;
	tw[260][3] = -2.6591;

	tw[261][0] = -166.136;
	tw[261][1] = 4.34611;
	tw[261][2] = -1.56563;
	tw[261][3] = -0.659948;

	tw[262][0] = -146.937;
	tw[262][1] = 5.90734;
	tw[262][2] = -1.60203;
	tw[262][3] = -1.75369;

	tw[263][0] = -164.805;
	tw[263][1] = 4.65886;
	tw[263][2] = -1.54458;
	tw[263][3] = -1.57989;

	tw[264][0] = -161.371;
	tw[264][1] = 5.20226;
	tw[264][2] = -1.34633;
	tw[264][3] = -1.23796;

	tw[265][0] = -165.634;
	tw[265][1] = 4.3131;
	tw[265][2] = -1.3661;
	tw[265][3] = -2.22602;

	tw[266][0] = -160.234;
	tw[266][1] = 4.38705;
	tw[266][2] = -1.38908;
	tw[266][3] = -0.996609;

	tw[267][0] = -175.998;
	tw[267][1] = 3.28623;
	tw[267][2] = -1.36029;
	tw[267][3] = -1.86127;

	tw[268][0] = -158.563;
	tw[268][1] = 4.64496;
	tw[268][2] = -1.41341;
	tw[268][3] = -1.48007;

	tw[269][0] = -157.656;
	tw[269][1] = 5.31996;
	tw[269][2] = -1.40184;
	tw[269][3] = -1.98762;

	tw[270][0] = -107.125;
	tw[270][1] = 7.90044;
	tw[270][2] = -1.51749;
	tw[270][3] = 1.51345;

	tw[271][0] = 0;
	tw[271][1] = 0;
	tw[271][2] = 0;
	tw[271][3] = 0;

	tw[272][0] = 0;
	tw[272][1] = 0;
	tw[272][2] = 0;
	tw[272][3] = 0;

	tw[273][0] = 0;
	tw[273][1] = 0;
	tw[273][2] = 0;
	tw[273][3] = 0;

	tw[274][0] = 0;
	tw[274][1] = 0;
	tw[274][2] = 0;
	tw[274][3] = 0;

	tw[275][0] = 0;
	tw[275][1] = 0;
	tw[275][2] = 0;
	tw[275][3] = 0;

	tw[276][0] = 0;
	tw[276][1] = 0;
	tw[276][2] = 0;
	tw[276][3] = 0;

	tw[277][0] = 0;
	tw[277][1] = 0;
	tw[277][2] = 0;
	tw[277][3] = 0;

	tw[278][0] = 0;
	tw[278][1] = 0;
	tw[278][2] = 0;
	tw[278][3] = 0;

	tw[279][0] = -100.78;
	tw[279][1] = 8.85086;
	tw[279][2] = -1.42371;
	tw[279][3] = 2.82417;

	tw[280][0] = -172.436;
	tw[280][1] = 3.95787;
	tw[280][2] = -1.62203;
	tw[280][3] = -1.37773;

	tw[281][0] = -171.96;
	tw[281][1] = 4.9131;
	tw[281][2] = -1.43821;
	tw[281][3] = -1.22997;

	tw[282][0] = -145.538;
	tw[282][1] = 5.64349;
	tw[282][2] = -1.48228;
	tw[282][3] = -1.94114;

	tw[283][0] = -158.738;
	tw[283][1] = 4.56004;
	tw[283][2] = -1.37762;
	tw[283][3] = -0.83363;

	tw[284][0] = -132.209;
	tw[284][1] = 5.55464;
	tw[284][2] = -1.42295;
	tw[284][3] = -1.93273;

	tw[285][0] = -148.499;
	tw[285][1] = 4.37381;
	tw[285][2] = -1.35262;
	tw[285][3] = -1.04899;

	tw[286][0] = -141.488;
	tw[286][1] = 4.88501;
	tw[286][2] = -1.36731;
	tw[286][3] = -1.1014;

	tw[287][0] = -151.803;
	tw[287][1] = 4.46771;
	tw[287][2] = -1.33079;
	tw[287][3] = -1.64912;

	tw[288][0] = -160.354;
	tw[288][1] = 3.70705;
	tw[288][2] = -1.31872;
	tw[288][3] = -1.70719;

	tw[289][0] = -153.738;
	tw[289][1] = 5.42625;
	tw[289][2] = -1.32845;
	tw[289][3] = -1.83772;

	tw[290][0] = -170.067;
	tw[290][1] = 3.97531;
	tw[290][2] = -1.32111;
	tw[290][3] = -2.16689;

	tw[291][0] = -167.555;
	tw[291][1] = 5.40514;
	tw[291][2] = -1.27666;
	tw[291][3] = -1.68128;

	tw[292][0] = -142.376;
	tw[292][1] = 8.03481;
	tw[292][2] = -1.32346;
	tw[292][3] = -0.384055;

	tw[293][0] = -117.703;
	tw[293][1] = 9.51892;
	tw[293][2] = -1.28613;
	tw[293][3] = -2.09166;

	tw[294][0] = 0;
	tw[294][1] = 0;
	tw[294][2] = 0;
	tw[294][3] = 0;

	tw[295][0] = 0;
	tw[295][1] = 0;
	tw[295][2] = 0;
	tw[295][3] = 0;

	tw[296][0] = 0;
	tw[296][1] = 0;
	tw[296][2] = 0;
	tw[296][3] = 0;

	tw[297][0] = 0;
	tw[297][1] = 0;
	tw[297][2] = 0;
	tw[297][3] = 0;

	tw[298][0] = 0;
	tw[298][1] = 0;
	tw[298][2] = 0;
	tw[298][3] = 0;

	tw[299][0] = 0;
	tw[299][1] = 0;
	tw[299][2] = 0;
	tw[299][3] = 0;

	tw[300][0] = -171.211;
	tw[300][1] = 7.06902;
	tw[300][2] = -1.28075;
	tw[300][3] = -2.45346;

	tw[301][0] = -149.433;
	tw[301][1] = 6.72901;
	tw[301][2] = -1.34023;
	tw[301][3] = 0.291107;

	tw[302][0] = -160.582;
	tw[302][1] = 4.77977;
	tw[302][2] = -1.40332;
	tw[302][3] = -2.55785;

	tw[303][0] = -165.677;
	tw[303][1] = 3.62183;
	tw[303][2] = -1.42028;
	tw[303][3] = -1.05048;

	tw[304][0] = -160.171;
	tw[304][1] = 8.05542;
	tw[304][2] = -1.46107;
	tw[304][3] = -1.70536;

	tw[305][0] = -199.62;
	tw[305][1] = 3.85958;
	tw[305][2] = -1.54324;
	tw[305][3] = -1.79596;

	tw[306][0] = -156.311;
	tw[306][1] = 5.57329;
	tw[306][2] = -1.60636;
	tw[306][3] = -1.71599;

	tw[307][0] = -150.444;
	tw[307][1] = 5.28783;
	tw[307][2] = -1.27226;
	tw[307][3] = -0.884018;

	tw[308][0] = 0;
	tw[308][1] = 0;
	tw[308][2] = 0;
	tw[308][3] = 0;

	tw[309][0] = -145.094;
	tw[309][1] = 4.39914;
	tw[309][2] = -1.31869;
	tw[309][3] = -1.88642;

	tw[310][0] = -145.026;
	tw[310][1] = 5.286;
	tw[310][2] = -1.153;
	tw[310][3] = -0.961528;

	tw[311][0] = -152.32;
	tw[311][1] = 3.16727;
	tw[311][2] = -1.23838;
	tw[311][3] = -1.43371;

	tw[312][0] = -148.556;
	tw[312][1] = 4.40114;
	tw[312][2] = -1.23944;
	tw[312][3] = -2.06712;

	tw[313][0] = -144.676;
	tw[313][1] = 3.98757;
	tw[313][2] = -1.26495;
	tw[313][3] = -2.1091;

	tw[314][0] = -154.928;
	tw[314][1] = 6.01118;
	tw[314][2] = -1.25031;
	tw[314][3] = -1.26682;

	tw[315][0] = -158.546;
	tw[315][1] = 6.26856;
	tw[315][2] = -1.23109;
	tw[315][3] = -2.00133;

	tw[316][0] = -172.736;
	tw[316][1] = 6.25266;
	tw[316][2] = -0.962736;
	tw[316][3] = -5;

	tw[317][0] = 0;
	tw[317][1] = 0;
	tw[317][2] = 0;
	tw[317][3] = 0;

	tw[318][0] = 0;
	tw[318][1] = 0;
	tw[318][2] = 0;
	tw[318][3] = 0;

	tw[319][0] = 0;
	tw[319][1] = 0;
	tw[319][2] = 0;
	tw[319][3] = 0;

	tw[320][0] = 0;
	tw[320][1] = 0;
	tw[320][2] = 0;
	tw[320][3] = 0;

	tw[321][0] = -188.027;
	tw[321][1] = 2.93075;
	tw[321][2] = -1.12065;
	tw[321][3] = -5;

	tw[322][0] = -159.074;
	tw[322][1] = 3.26023;
	tw[322][2] = -1.20196;
	tw[322][3] = -1.4266;

	tw[323][0] = -144.936;
	tw[323][1] = 3.48232;
	tw[323][2] = -1.24497;
	tw[323][3] = -1.03848;

	tw[324][0] = -145.733;
	tw[324][1] = 4.21285;
	tw[324][2] = -1.23537;
	tw[324][3] = -2.82731;

	tw[325][0] = -144.331;
	tw[325][1] = 4.44166;
	tw[325][2] = -1.22123;
	tw[325][3] = -0.572314;

	tw[326][0] = -132.953;
	tw[326][1] = 5.28432;
	tw[326][2] = -1.23836;
	tw[326][3] = -2.11198;

	tw[327][0] = -147.08;
	tw[327][1] = 3.61534;
	tw[327][2] = -1.25989;
	tw[327][3] = -1.36834;

	tw[328][0] = -126.539;
	tw[328][1] = 4.30219;
	tw[328][2] = -1.3105;
	tw[328][3] = -1.68052;

	tw[329][0] = 0;
	tw[329][1] = 0;
	tw[329][2] = 0;
	tw[329][3] = 0;

	tw[330][0] = 0;
	tw[330][1] = 0;
	tw[330][2] = 0;
	tw[330][3] = 0;

	tw[331][0] = -129.544;
	tw[331][1] = 4.86878;
	tw[331][2] = -1.2393;
	tw[331][3] = -1.51384;

	tw[332][0] = -131.618;
	tw[332][1] = 5.33609;
	tw[332][2] = -1.09986;
	tw[332][3] = -1.35137;

	tw[333][0] = -146.959;
	tw[333][1] = 3.43987;
	tw[333][2] = -1.15282;
	tw[333][3] = -1.97827;

	tw[334][0] = -137.61;
	tw[334][1] = 4.31827;
	tw[334][2] = -1.17427;
	tw[334][3] = -1.94957;

	tw[335][0] = -132.827;
	tw[335][1] = 3.98629;
	tw[335][2] = -1.20125;
	tw[335][3] = -1.15952;

	tw[336][0] = -136.574;
	tw[336][1] = 3.37495;
	tw[336][2] = -1.2088;
	tw[336][3] = -1.76133;

	tw[337][0] = -140.072;
	tw[337][1] = 5.68827;
	tw[337][2] = -1.17045;
	tw[337][3] = -2.79301;

	tw[338][0] = -126.034;
	tw[338][1] = 6.98426;
	tw[338][2] = -1.18942;
	tw[338][3] = -0.27984;

	tw[339][0] = -122.427;
	tw[339][1] = 5.54647;
	tw[339][2] = -1.25959;
	tw[339][3] = -2.30644;

	tw[340][0] = -136.04;
	tw[340][1] = 7.95613;
	tw[340][2] = -1.28545;
	tw[340][3] = 0.23607;

	tw[341][0] = -182.752;
	tw[341][1] = 3.84057;
	tw[341][2] = -1.39086;
	tw[341][3] = -1.7417;

	tw[342][0] = -170.843;
	tw[342][1] = 5.75914;
	tw[342][2] = -1.428;
	tw[342][3] = -1.20251;

	tw[343][0] = -147.198;
	tw[343][1] = 4.67814;
	tw[343][2] = -1.50435;
	tw[343][3] = -1.78401;

	tw[344][0] = -184.537;
	tw[344][1] = 6.505;
	tw[344][2] = -1.48298;
	tw[344][3] = -1.16465;

	tw[345][0] = -205.668;
	tw[345][1] = 3.95418;
	tw[345][2] = -1.52432;
	tw[345][3] = -2.19069;

	tw[346][0] = -175.648;
	tw[346][1] = 5.21352;
	tw[346][2] = -1.58213;
	tw[346][3] = -1.89061;

	tw[347][0] = -202.676;
	tw[347][1] = 2.04451;
	tw[347][2] = -1.62617;
	tw[347][3] = -1.74197;

	tw[348][0] = -188.309;
	tw[348][1] = 7.96741;
	tw[348][2] = -1.90045;
	tw[348][3] = -0.712945;

	tw[349][0] = -217.696;
	tw[349][1] = 5.91696;
	tw[349][2] = -1.86223;
	tw[349][3] = -1.65521;

	tw[350][0] = -205.286;
	tw[350][1] = 4.74586;
	tw[350][2] = -1.89536;
	tw[350][3] = -1.88992;

	tw[351][0] = 0;
	tw[351][1] = 0;
	tw[351][2] = 0;
	tw[351][3] = 0;

	tw[352][0] = 0;
	tw[352][1] = 0;
	tw[352][2] = 0;
	tw[352][3] = 0;

	tw[353][0] = -167.11;
	tw[353][1] = 7.38203;
	tw[353][2] = -1.77395;
	tw[353][3] = -0.33285;

	tw[354][0] = -197.43;
	tw[354][1] = 5.52382;
	tw[354][2] = -1.7629;
	tw[354][3] = -2.63859;

	tw[355][0] = -192.008;
	tw[355][1] = 5.90626;
	tw[355][2] = -1.76556;
	tw[355][3] = -0.839433;

	tw[356][0] = -204.671;
	tw[356][1] = 6.09839;
	tw[356][2] = -1.67805;
	tw[356][3] = -2.05705;

	tw[357][0] = -197.288;
	tw[357][1] = 5.04011;
	tw[357][2] = -1.7246;
	tw[357][3] = -0.80313;

	tw[358][0] = -221.246;
	tw[358][1] = 3.46579;
	tw[358][2] = -1.62169;
	tw[358][3] = -1.89401;

	tw[359][0] = -182.857;
	tw[359][1] = 6.5365;
	tw[359][2] = -1.69637;
	tw[359][3] = -1.86066;

	tw[360][0] = -182.568;
	tw[360][1] = 5.28052;
	tw[360][2] = -1.48225;
	tw[360][3] = 0.32413;

	tw[361][0] = -170.28;
	tw[361][1] = 8.65903;
	tw[361][2] = -1.46684;
	tw[361][3] = -1.65204;

	tw[362][0] = -162.17;
	tw[362][1] = 7.204;
	tw[362][2] = -1.51548;
	tw[362][3] = -2.10471;

	tw[363][0] = -200.218;
	tw[363][1] = 3.53305;
	tw[363][2] = -1.58533;
	tw[363][3] = -1.33427;

	tw[364][0] = -217.672;
	tw[364][1] = 1.86616;
	tw[364][2] = -1.55972;
	tw[364][3] = -2.08176;

	tw[365][0] = -197.112;
	tw[365][1] = 5.77936;
	tw[365][2] = -1.70448;
	tw[365][3] = -1.64556;

	tw[366][0] = -189.883;
	tw[366][1] = 6.06572;
	tw[366][2] = -1.72408;
	tw[366][3] = -1.46519;

	tw[367][0] = -214.797;
	tw[367][1] = 4.01145;
	tw[367][2] = -1.68914;
	tw[367][3] = -2.12305;

	tw[368][0] = -178.324;
	tw[368][1] = 5.25841;
	tw[368][2] = -1.75367;
	tw[368][3] = -1.3375;

	tw[369][0] = -180.517;
	tw[369][1] = 5.74213;
	tw[369][2] = -1.72735;
	tw[369][3] = -1.82682;

	tw[370][0] = -169.249;
	tw[370][1] = 7.18691;
	tw[370][2] = -1.64472;
	tw[370][3] = -1.17128;

	tw[371][0] = -157.045;
	tw[371][1] = 7.2989;
	tw[371][2] = -1.6737;
	tw[371][3] = -1.84941;

	tw[372][0] = -171.32;
	tw[372][1] = 5.71686;
	tw[372][2] = -1.68074;
	tw[372][3] = -1.50987;

	tw[373][0] = 0;
	tw[373][1] = 0;
	tw[373][2] = 0;
	tw[373][3] = 0;

	tw[374][0] = 0;
	tw[374][1] = 0;
	tw[374][2] = 0;
	tw[374][3] = 0;

	tw[375][0] = 0;
	tw[375][1] = 0;
	tw[375][2] = 0;
	tw[375][3] = 0;

	tw[376][0] = -158.971;
	tw[376][1] = 7.77719;
	tw[376][2] = -1.68933;
	tw[376][3] = -1.25053;

	tw[377][0] = -197.851;
	tw[377][1] = 4.91888;
	tw[377][2] = -1.5628;
	tw[377][3] = -1.06279;

	tw[378][0] = -169.194;
	tw[378][1] = 5.24465;
	tw[378][2] = -1.60598;
	tw[378][3] = -2.40692;

	tw[379][0] = 0;
	tw[379][1] = 0;
	tw[379][2] = 0;
	tw[379][3] = 0;

	tw[380][0] = -164.668;
	tw[380][1] = 5.44684;
	tw[380][2] = -1.62505;
	tw[380][3] = -1.17978;

	tw[381][0] = -175.451;
	tw[381][1] = 5.59609;
	tw[381][2] = -1.54832;
	tw[381][3] = -2.05409;

	tw[382][0] = -177.038;
	tw[382][1] = 5.68524;
	tw[382][2] = -1.53925;
	tw[382][3] = -2.38993;

	tw[383][0] = -181.021;
	tw[383][1] = 4.70837;
	tw[383][2] = -1.55221;
	tw[383][3] = -1.82308;

	tw[384][0] = -168.293;
	tw[384][1] = 7.86597;
	tw[384][2] = -1.56241;
	tw[384][3] = -1.42546;

	tw[385][0] = -183.18;
	tw[385][1] = 6.64446;
	tw[385][2] = -1.54509;
	tw[385][3] = -0.549269;

	tw[386][0] = -196.665;
	tw[386][1] = 4.2586;
	tw[386][2] = -1.60572;
	tw[386][3] = -3.41712;

	tw[387][0] = -185.345;
	tw[387][1] = 4.1282;
	tw[387][2] = -1.66874;
	tw[387][3] = -1.34415;

	tw[388][0] = -178.784;
	tw[388][1] = 5.99263;
	tw[388][2] = -1.6742;
	tw[388][3] = -2.16786;

	tw[389][0] = -171.964;
	tw[389][1] = 6.26298;
	tw[389][2] = -1.70241;
	tw[389][3] = -0.939451;

	tw[390][0] = -186.737;
	tw[390][1] = 5.77867;
	tw[390][2] = -1.64048;
	tw[390][3] = -1.93072;

	tw[391][0] = -179.716;
	tw[391][1] = 6.39397;
	tw[391][2] = -1.65682;
	tw[391][3] = -1.47009;

	tw[392][0] = -161.115;
	tw[392][1] = 8.11194;
	tw[392][2] = -1.68651;
	tw[392][3] = -0.987973;

	tw[393][0] = -188.471;
	tw[393][1] = 6.09705;
	tw[393][2] = -1.67923;
	tw[393][3] = -2.17643;

	tw[394][0] = 0;
	tw[394][1] = 0;
	tw[394][2] = 0;
	tw[394][3] = 0;

	tw[395][0] = 0;
	tw[395][1] = 0;
	tw[395][2] = 0;
	tw[395][3] = 0;

	tw[396][0] = 0;
	tw[396][1] = 0;
	tw[396][2] = 0;
	tw[396][3] = 0;

	tw[397][0] = 0;
	tw[397][1] = 0;
	tw[397][2] = 0;
	tw[397][3] = 0;

	tw[398][0] = 0;
	tw[398][1] = 0;
	tw[398][2] = 0;
	tw[398][3] = 0;

	tw[399][0] = -194.171;
	tw[399][1] = 5.11222;
	tw[399][2] = -1.68972;
	tw[399][3] = -1.05571;

	tw[400][0] = -186.057;
	tw[400][1] = 6.88723;
	tw[400][2] = -1.68618;
	tw[400][3] = -2.04726;

	tw[401][0] = -175.403;
	tw[401][1] = 5.63245;
	tw[401][2] = -1.74617;
	tw[401][3] = -0.086591;

	tw[402][0] = -185.386;
	tw[402][1] = 5.22078;
	tw[402][2] = -1.73445;
	tw[402][3] = -1.73509;

	tw[403][0] = -183.474;
	tw[403][1] = 4.90363;
	tw[403][2] = -1.53115;
	tw[403][3] = -1.13692;

	tw[404][0] = -180.477;
	tw[404][1] = 7.30299;
	tw[404][2] = -1.38387;
	tw[404][3] = -1.59715;

	tw[405][0] = -205.096;
	tw[405][1] = 3.20856;
	tw[405][2] = -1.50765;
	tw[405][3] = -1.98716;

	tw[406][0] = -183.799;
	tw[406][1] = 6.79326;
	tw[406][2] = -1.59324;
	tw[406][3] = -2.07121;

	tw[407][0] = -208.115;
	tw[407][1] = 4.41116;
	tw[407][2] = -1.60284;
	tw[407][3] = -2.10165;

	tw[408][0] = -166.54;
	tw[408][1] = 6.31956;
	tw[408][2] = -1.7229;
	tw[408][3] = 0.381846;

	tw[409][0] = -188.735;
	tw[409][1] = 5.48867;
	tw[409][2] = -1.66334;
	tw[409][3] = -1.52081;

	tw[410][0] = -167.782;
	tw[410][1] = 8.1992;
	tw[410][2] = -1.71486;
	tw[410][3] = -1.1552;

	tw[411][0] = -180.319;
	tw[411][1] = 6.23083;
	tw[411][2] = -1.74675;
	tw[411][3] = -1.31019;

	tw[412][0] = -180.115;
	tw[412][1] = 5.95617;
	tw[412][2] = -1.75626;
	tw[412][3] = -1.53363;

	tw[413][0] = -199.135;
	tw[413][1] = 4.09559;
	tw[413][2] = -1.74969;
	tw[413][3] = -1.55582;

	tw[414][0] = -195.165;
	tw[414][1] = 5.728;
	tw[414][2] = -1.7519;
	tw[414][3] = -1.64377;

	tw[415][0] = 0;
	tw[415][1] = 0;
	tw[415][2] = 0;
	tw[415][3] = 0;

	tw[416][0] = 0;
	tw[416][1] = 0;
	tw[416][2] = 0;
	tw[416][3] = 0;

	tw[417][0] = 0;
	tw[417][1] = 0;
	tw[417][2] = 0;
	tw[417][3] = 0;

	tw[418][0] = 0;
	tw[418][1] = 0;
	tw[418][2] = 0;
	tw[418][3] = 0;

	tw[419][0] = 0;
	tw[419][1] = 0;
	tw[419][2] = 0;
	tw[419][3] = 0;

	tw[420][0] = 0;
	tw[420][1] = 0;
	tw[420][2] = 0;
	tw[420][3] = 0;

	tw[421][0] = 0;
	tw[421][1] = 0;
	tw[421][2] = 0;
	tw[421][3] = 0;

	tw[422][0] = -159.609;
	tw[422][1] = 7.78853;
	tw[422][2] = -1.79864;
	tw[422][3] = -1.52627;

	tw[423][0] = -172.43;
	tw[423][1] = 5.67379;
	tw[423][2] = -1.5568;
	tw[423][3] = -0.778665;

	tw[424][0] = -184.716;
	tw[424][1] = 4.00571;
	tw[424][2] = -1.58515;
	tw[424][3] = -2.24567;

	tw[425][0] = -182.853;
	tw[425][1] = 8.48958;
	tw[425][2] = -1.60646;
	tw[425][3] = -1.05636;

	tw[426][0] = -166.196;
	tw[426][1] = 7.36848;
	tw[426][2] = -1.6549;
	tw[426][3] = -2.01274;

	tw[427][0] = -171.227;
	tw[427][1] = 6.7725;
	tw[427][2] = -1.65957;
	tw[427][3] = -1.17919;

	tw[428][0] = -182.247;
	tw[428][1] = 6.57114;
	tw[428][2] = -1.61379;
	tw[428][3] = -1.92448;

	tw[429][0] = -171.361;
	tw[429][1] = 6.46431;
	tw[429][2] = -1.65532;
	tw[429][3] = -0.621626;

	tw[430][0] = -160.758;
	tw[430][1] = 7.08086;
	tw[430][2] = -1.67656;
	tw[430][3] = -2.43642;

	tw[431][0] = -154.738;
	tw[431][1] = 7.56016;
	tw[431][2] = -1.67745;
	tw[431][3] = -0.649367;

	tw[432][0] = -148.783;
	tw[432][1] = 8.00078;
	tw[432][2] = -1.42365;
	tw[432][3] = -0.717365;

	tw[433][0] = -174.661;
	tw[433][1] = 3.7615;
	tw[433][2] = -1.55413;
	tw[433][3] = -2.22627;

	tw[434][0] = -180.131;
	tw[434][1] = 7.92065;
	tw[434][2] = -1.57105;
	tw[434][3] = -0.642266;

	tw[435][0] = -213.87;
	tw[435][1] = 5.1241;
	tw[435][2] = -1.58665;
	tw[435][3] = -2.47425;

	tw[436][0] = 0;
	tw[436][1] = 0;
	tw[436][2] = 0;
	tw[436][3] = 0;

	tw[437][0] = 0;
	tw[437][1] = 0;
	tw[437][2] = 0;
	tw[437][3] = 0;

	tw[438][0] = 0;
	tw[438][1] = 0;
	tw[438][2] = 0;
	tw[438][3] = 0;

	tw[439][0] = 0;
	tw[439][1] = 0;
	tw[439][2] = 0;
	tw[439][3] = 0;

	tw[440][0] = 0;
	tw[440][1] = 0;
	tw[440][2] = 0;
	tw[440][3] = 0;

	tw[441][0] = 0;
	tw[441][1] = 0;
	tw[441][2] = 0;
	tw[441][3] = 0;

	tw[442][0] = 0;
	tw[442][1] = 0;
	tw[442][2] = 0;
	tw[442][3] = 0;

	tw[443][0] = 0;
	tw[443][1] = 0;
	tw[443][2] = 0;
	tw[443][3] = 0;

	tw[444][0] = 0;
	tw[444][1] = 0;
	tw[444][2] = 0;
	tw[444][3] = 0;

	tw[445][0] = -183.033;
	tw[445][1] = 5.4443;
	tw[445][2] = -1.66494;
	tw[445][3] = 0.120531;

	tw[446][0] = -192.686;
	tw[446][1] = 6.19693;
	tw[446][2] = -1.62178;
	tw[446][3] = -2.15333;

	tw[447][0] = -208.024;
	tw[447][1] = 4.23575;
	tw[447][2] = -1.6414;
	tw[447][3] = -1.55469;

	tw[448][0] = -176.623;
	tw[448][1] = 6.86193;
	tw[448][2] = -1.6995;
	tw[448][3] = -1.74629;

	tw[449][0] = -187.372;
	tw[449][1] = 5.76814;
	tw[449][2] = -1.69072;
	tw[449][3] = -0.820857;

	tw[450][0] = -196.184;
	tw[450][1] = 6.66291;
	tw[450][2] = -1.63221;
	tw[450][3] = -2.35015;

	tw[451][0] = -176.119;
	tw[451][1] = 6.22893;
	tw[451][2] = -1.68485;
	tw[451][3] = -1.2807;

	tw[452][0] = -149.77;
	tw[452][1] = 8.32223;
	tw[452][2] = -1.71698;
	tw[452][3] = -1.45969;

	tw[453][0] = -151.232;
	tw[453][1] = 8.18754;
	tw[453][2] = -1.35312;
	tw[453][3] = -0.417005;

	tw[454][0] = -129.629;
	tw[454][1] = 6.67154;
	tw[454][2] = -1.42857;
	tw[454][3] = -1.81252;

	tw[455][0] = -135.21;
	tw[455][1] = 6.63061;
	tw[455][2] = -1.3787;
	tw[455][3] = -1.05281;

	tw[456][0] = -155.141;
	tw[456][1] = 5.06235;
	tw[456][2] = -1.37275;
	tw[456][3] = -2.14543;

	tw[457][0] = 0;
	tw[457][1] = 0;
	tw[457][2] = 0;
	tw[457][3] = 0;

	tw[458][0] = 0;
	tw[458][1] = 0;
	tw[458][2] = 0;
	tw[458][3] = 0;

	tw[459][0] = 0;
	tw[459][1] = 0;
	tw[459][2] = 0;
	tw[459][3] = 0;

	tw[460][0] = 0;
	tw[460][1] = 0;
	tw[460][2] = 0;
	tw[460][3] = 0;

	tw[461][0] = 0;
	tw[461][1] = 0;
	tw[461][2] = 0;
	tw[461][3] = 0;

	tw[462][0] = 0;
	tw[462][1] = 0;
	tw[462][2] = 0;
	tw[462][3] = 0;

	tw[463][0] = 0;
	tw[463][1] = 0;
	tw[463][2] = 0;
	tw[463][3] = 0;

	tw[464][0] = 0;
	tw[464][1] = 0;
	tw[464][2] = 0;
	tw[464][3] = 0;

	tw[465][0] = 0;
	tw[465][1] = 0;
	tw[465][2] = 0;
	tw[465][3] = 0;

	tw[466][0] = 0;
	tw[466][1] = 0;
	tw[466][2] = 0;
	tw[466][3] = 0;

	tw[467][0] = 0;
	tw[467][1] = 0;
	tw[467][2] = 0;
	tw[467][3] = 0;

	tw[468][0] = 0;
	tw[468][1] = 0;
	tw[468][2] = 0;
	tw[468][3] = 0;

	tw[469][0] = 0;
	tw[469][1] = 0;
	tw[469][2] = 0;
	tw[469][3] = 0;

	tw[470][0] = -132.673;
	tw[470][1] = 6.65737;
	tw[470][2] = -1.4175;
	tw[470][3] = -1.50379;

	tw[471][0] = -152.36;
	tw[471][1] = 5.32716;
	tw[471][2] = -1.39913;
	tw[471][3] = -0.981818;

	tw[472][0] = -134.351;
	tw[472][1] = 6.9083;
	tw[472][2] = -1.42025;
	tw[472][3] = -1.44922;

	tw[473][0] = -147.931;
	tw[473][1] = 5.30822;
	tw[473][2] = -1.45108;
	tw[473][3] = -0.511904;

	tw[474][0] = -127.894;
	tw[474][1] = 6.24822;
	tw[474][2] = -1.48429;
	tw[474][3] = -1.2052;

	tw[475][0] = -143.778;
	tw[475][1] = 5.2077;
	tw[475][2] = -1.46608;
	tw[475][3] = -1.21897;

	tw[476][0] = 0;
	tw[476][1] = 0;
	tw[476][2] = 0;
	tw[476][3] = 0;

	tw[477][0] = 0;
	tw[477][1] = 0;
	tw[477][2] = 0;
	tw[477][3] = 0;

	tw[478][0] = 0;
	tw[478][1] = 0;
	tw[478][2] = 0;
	tw[478][3] = 0;

	tw[479][0] = 0;
	tw[479][1] = 0;
	tw[479][2] = 0;
	tw[479][3] = 0;

	tw[480][0] = 0;
	tw[480][1] = 0;
	tw[480][2] = 0;
	tw[480][3] = 0;

	tw[481][0] = 0;
	tw[481][1] = 0;
	tw[481][2] = 0;
	tw[481][3] = 0;

	tw[482][0] = 0;
	tw[482][1] = 0;
	tw[482][2] = 0;
	tw[482][3] = 0;

	tw[483][0] = 0;
	tw[483][1] = 0;
	tw[483][2] = 0;
	tw[483][3] = 0;

	tw[484][0] = 0;
	tw[484][1] = 0;
	tw[484][2] = 0;
	tw[484][3] = 0;

	tw[485][0] = 0;
	tw[485][1] = 0;
	tw[485][2] = 0;
	tw[485][3] = 0;

	tw[486][0] = 0;
	tw[486][1] = 0;
	tw[486][2] = 0;
	tw[486][3] = 0;

	tw[487][0] = 0;
	tw[487][1] = 0;
	tw[487][2] = 0;
	tw[487][3] = 0;

	tw[488][0] = 0;
	tw[488][1] = 0;
	tw[488][2] = 0;
	tw[488][3] = 0;

	tw[489][0] = 0;
	tw[489][1] = 0;
	tw[489][2] = 0;
	tw[489][3] = 0;

	tw[490][0] = 0;
	tw[490][1] = 0;
	tw[490][2] = 0;
	tw[490][3] = 0;

	tw[491][0] = 0;
	tw[491][1] = 0;
	tw[491][2] = 0;
	tw[491][3] = 0;

	tw[492][0] = 0;
	tw[492][1] = 0;
	tw[492][2] = 0;
	tw[492][3] = 0;

	tw[493][0] = 0;
	tw[493][1] = 0;
	tw[493][2] = 0;
	tw[493][3] = 0;

	tw[494][0] = 0;
	tw[494][1] = 0;
	tw[494][2] = 0;
	tw[494][3] = 0;

	tw[495][0] = 0;
	tw[495][1] = 0;
	tw[495][2] = 0;
	tw[495][3] = 0;

	tw[496][0] = 0;
	tw[496][1] = 0;
	tw[496][2] = 0;
	tw[496][3] = 0;

	tw[497][0] = 0;
	tw[497][1] = 0;
	tw[497][2] = 0;
	tw[497][3] = 0;

	tw[498][0] = 0;
	tw[498][1] = 0;
	tw[498][2] = 0;
	tw[498][3] = 0;

	tw[499][0] = 0;
	tw[499][1] = 0;
	tw[499][2] = 0;
	tw[499][3] = 0;

}

FTCalHitEneCorr_factory::~FTCalHitEneCorr_factory() {
	// TODO Auto-generated destructor stub

}

void FTCalHitEneCorr_factory::Init() {

}
void FTCalHitEneCorr_factory::ChangeRun(const std::shared_ptr<const JEvent> &aEvent) {

	if (m_tt == 0) {
		//std::cout << "FTCalHit_factory::get TT" << std::endl;
		m_tt = aEvent->GetSingle<TranslationTable>();
		//	std::cout << "FTCalHit_factory: got TT" << std::endl;
	}

	static int hasLoaded = 0;
	if (hasLoaded == 0) {
		auto jcalib_manager = japp->GetService<JCalibrationManager>();
		static int runN = 13000;
		auto jcalib = jcalib_manager->GetJCalibration(13000);

		//Load FT-HODO
		std::vector<std::vector<double>> data;
		jcalib->Get("/calibration/ft/ftcal/charge_to_energy", data);

		for (auto row : data) {
			//sector - layer - component - mips_charge - mips_energy - fadc_to_charge - preamp_gain - apd_gain
			auto sector = int(row[0]);
			auto layer = int(row[1]);
			auto component = int(row[2]);
			mips_charge[component] = row[3];
			cout << sector<< " "<<layer<<" "<<" "<<layer<<" "<<mips_charge[component]<<endl;
		}

		daq_gain[0][3][0] = 0.118104;
		daq_gain[0][3][1] = 0.155948;
		daq_gain[0][3][2] = 0.137848;
		daq_gain[0][3][3] = 0.137981;
		daq_gain[0][3][4] = 0.14011;
		daq_gain[0][3][5] = 0.14685;
		daq_gain[0][3][6] = 0.17934;
		daq_gain[0][3][7] = 0.119183;
		daq_gain[0][3][8] = 0.16009;
		daq_gain[0][3][9] = 0.17934;
		daq_gain[0][3][10] = 0.128837;
		daq_gain[0][3][11] = 0.132993;
		daq_gain[0][3][12] = 0.151598;
		daq_gain[0][3][13] = 0.151534;
		daq_gain[0][3][14] = 0.14691;
		daq_gain[0][3][15] = 0.0017934;

		daq_gain[0][4][0] = 0.129394;
		daq_gain[0][4][1] = 0.131337;
		daq_gain[0][4][2] = 0.17934;
		daq_gain[0][4][3] = 0.174117;
		daq_gain[0][4][4] = 0.130834;
		daq_gain[0][4][5] = 0.17934;
		daq_gain[0][4][6] = 0.161896;
		daq_gain[0][4][7] = 0.150928;
		daq_gain[0][4][8] = 0.174117;
		daq_gain[0][4][9] = 0.17934;
		daq_gain[0][4][10] = 0.153907;
		daq_gain[0][4][11] = 0.147061;
		daq_gain[0][4][12] = 0.140137;
		daq_gain[0][4][13] = 0.17934;
		daq_gain[0][4][14] = 0.17934;
		daq_gain[0][4][15] = 0.163259;

		daq_gain[0][5][0] = 0.154139;
		daq_gain[0][5][1] = 0.157974;
		daq_gain[0][5][2] = 0.175997;
		daq_gain[0][5][3] = 0.15787;
		daq_gain[0][5][4] = 0.139673;
		daq_gain[0][5][5] = 0.137981;
		daq_gain[0][5][6] = 0.144892;
		daq_gain[0][5][7] = 0.17934;
		daq_gain[0][5][8] = 0.163557;
		daq_gain[0][5][9] = 0.140411;
		daq_gain[0][5][10] = 0.17591;
		daq_gain[0][5][11] = 0.17934;
		daq_gain[0][5][12] = 0.143962;
		daq_gain[0][5][13] = 0.120363;
		daq_gain[0][5][14] = 0.141241;
		daq_gain[0][5][15] = 0.239121;

		daq_gain[0][6][0] = 0.143933;
		daq_gain[0][6][1] = 0.149016;
		daq_gain[0][6][2] = 0.17934;
		daq_gain[0][6][3] = 0.121876;
		daq_gain[0][6][4] = 0.147666;
		daq_gain[0][6][5] = 0.130028;
		daq_gain[0][6][6] = 0.126944;
		daq_gain[0][6][7] = 0.144309;
		daq_gain[0][6][8] = 0.152371;
		daq_gain[0][6][9] = 0.123982;
		daq_gain[0][6][10] = 0.117408;
		daq_gain[0][6][11] = 0.117082;
		daq_gain[0][6][12] = 0.122962;
		daq_gain[0][6][13] = 0.140991;
		daq_gain[0][6][14] = 0.138916;
		daq_gain[0][6][15] = 0.170638;

		daq_gain[0][7][0] = 0.1196;
		daq_gain[0][7][1] = 0.11994;
		daq_gain[0][7][2] = 0.109421;
		daq_gain[0][7][3] = 0.132599;
		daq_gain[0][7][4] = 0.144513;
		daq_gain[0][7][5] = 0.149513;
		daq_gain[0][7][6] = 0.138407;
		daq_gain[0][7][7] = 0.118416;
		daq_gain[0][7][8] = 0.12198;
		daq_gain[0][7][9] = 0.154238;
		daq_gain[0][7][10] = 0.125963;
		daq_gain[0][7][11] = 0.127554;
		daq_gain[0][7][12] = 0.126163;
		daq_gain[0][7][13] = 0.137769;
		daq_gain[0][7][14] = 0.204961;
		daq_gain[0][7][15] = 0.127963;

		daq_gain[0][8][0] = 0.128813;
		daq_gain[0][8][1] = 0.127986;
		daq_gain[0][8][2] = 0.154737;
		daq_gain[0][8][3] = 0.137242;
		daq_gain[0][8][4] = 0.128421;
		daq_gain[0][8][5] = 0.116568;
		daq_gain[0][8][6] = 0.124564;
		daq_gain[0][8][7] = 0.11604;
		daq_gain[0][8][8] = 0.11992;
		daq_gain[0][8][9] = 0.14011;
		daq_gain[0][8][10] = 0.139946;
		daq_gain[0][8][11] = 0.145127;
		daq_gain[0][8][12] = 0.141185;
		daq_gain[0][8][13] = 0.131337;
		daq_gain[0][8][14] = 0.127079;
		daq_gain[0][8][15] = 0.111565;

		daq_gain[0][9][0] = 0.147091;
		daq_gain[0][9][1] = 0.12849;
		daq_gain[0][9][2] = 0.140274;
		daq_gain[0][9][3] = 0.128583;
		daq_gain[0][9][4] = 0.140165;
		daq_gain[0][9][5] = 0.17934;
		daq_gain[0][9][6] = 0.11824;
		daq_gain[0][9][7] = 0.136096;
		daq_gain[0][9][8] = 0.131169;
		daq_gain[0][9][9] = 0.138728;
		daq_gain[0][9][10] = 0.115036;
		daq_gain[0][9][11] = 0.153054;
		daq_gain[0][9][12] = 0.124932;
		daq_gain[0][9][13] = 0.142503;
		daq_gain[0][9][14] = 0.125743;
		daq_gain[0][9][15] = 0.167922;

		daq_gain[0][10][0] = 0.158638;
		daq_gain[0][10][1] = 0.204961;
		daq_gain[0][10][2] = 0.121546;
		daq_gain[0][10][3] = 0.162042;
		daq_gain[0][10][4] = 0.126252;
		daq_gain[0][10][5] = 0.168474;
		daq_gain[0][10][6] = 0.144892;
		daq_gain[0][10][7] = 0.140521;
		daq_gain[0][10][8] = 0.123747;
		daq_gain[0][10][9] = 0.130834;
		daq_gain[0][10][10] = 0.139728;
		daq_gain[0][10][11] = 0.122396;
		daq_gain[0][10][12] = 0.125216;
		daq_gain[0][10][13] = 0.134893;
		daq_gain[0][10][14] = 0.148892;
		daq_gain[0][10][15] = 0.167412;

		daq_gain[0][13][0] = 0.125633;
		daq_gain[0][13][1] = 0.204961;
		daq_gain[0][13][2] = 0.17934;
		daq_gain[0][13][3] = 0.17934;
		daq_gain[0][13][4] = 0.151119;
		daq_gain[0][13][5] = 0.179251;
		daq_gain[0][13][6] = 0.126497;
		daq_gain[0][13][7] = 0.144338;
		daq_gain[0][13][8] = 0.14548;
		daq_gain[0][13][9] = 0.204961;
		daq_gain[0][13][10] = 0.177521;
		daq_gain[0][13][11] = 0.17934;
		daq_gain[0][13][12] = 0.15039;
		daq_gain[0][13][13] = 0.204961;
		daq_gain[0][13][14] = 0.124197;
		daq_gain[0][13][15] = 0.147151;

		daq_gain[0][14][0] = 0.165253;
		daq_gain[0][14][1] = 0.112881;
		daq_gain[0][14][2] = 0.17934;
		daq_gain[0][14][3] = 0.148062;
		daq_gain[0][14][4] = 0.122312;
		daq_gain[0][14][5] = 0.142193;
		daq_gain[0][14][6] = 0.127012;
		daq_gain[0][14][7] = 0.159308;
		daq_gain[0][14][8] = 0.129115;
		daq_gain[0][14][9] = 0.17934;
		daq_gain[0][14][10] = 0.138034;
		daq_gain[0][14][11] = 0.132599;
		daq_gain[0][14][12] = 0.149669;
		daq_gain[0][14][13] = 0.166945;
		daq_gain[0][14][14] = 0.17934;
		daq_gain[0][14][15] = 0.129511;

		daq_gain[0][15][0] = 0.148861;
		daq_gain[0][15][1] = 0.11153;
		daq_gain[0][15][2] = 0.128675;
		daq_gain[0][15][3] = 0.204961;
		daq_gain[0][15][4] = 0.130169;
		daq_gain[0][15][5] = 0.153874;
		daq_gain[0][15][6] = 0.160484;
		daq_gain[0][15][7] = 0.129581;
		daq_gain[0][15][8] = 0.117755;
		daq_gain[0][15][9] = 0.141408;
		daq_gain[0][15][10] = 0.17934;
		daq_gain[0][15][11] = 0.161277;
		daq_gain[0][15][12] = 1;
		daq_gain[0][15][13] = 1;
		daq_gain[0][15][14] = 1;
		daq_gain[0][15][15] = 1;

		daq_gain[1][3][0] = 0.17934;
		daq_gain[1][3][1] = 0.148277;
		daq_gain[1][3][2] = 0.17934;
		daq_gain[1][3][3] = 0.164306;
		daq_gain[1][3][4] = 0.155475;
		daq_gain[1][3][5] = 0.147514;
		daq_gain[1][3][6] = 0.17934;
		daq_gain[1][3][7] = 0.137716;
		daq_gain[1][3][8] = 0.204961;
		daq_gain[1][3][9] = 0.139321;
		daq_gain[1][3][10] = 0.150675;
		daq_gain[1][3][11] = 0.131121;
		daq_gain[1][3][12] = 0.13951;
		daq_gain[1][3][13] = 0.130122;
		daq_gain[1][3][14] = 0.239121;
		daq_gain[1][3][15] = 0.17934;

		daq_gain[1][4][0] = 0.145865;
		daq_gain[1][4][1] = 0.204961;
		daq_gain[1][4][2] = 0.14273;
		daq_gain[1][4][3] = 0.130596;
		daq_gain[1][4][4] = 0.126052;
		daq_gain[1][4][5] = 0.204961;
		daq_gain[1][4][6] = 0.17934;
		daq_gain[1][4][7] = 0.176343;
		daq_gain[1][4][8] = 0.136407;
		daq_gain[1][4][9] = 0.142475;
		daq_gain[1][4][10] = 0.136692;
		daq_gain[1][4][11] = 0.16895;
		daq_gain[1][4][12] = 0.138034;
		daq_gain[1][4][13] = 0.168632;
		daq_gain[1][4][14] = 0.126363;
		daq_gain[1][4][15] = 0.17934;

		daq_gain[1][5][0] = 0.178804;
		daq_gain[1][5][1] = 0.121566;
		daq_gain[1][5][2] = 0.151342;
		daq_gain[1][5][3] = 0.125523;
		daq_gain[1][5][4] = 0.118887;
		daq_gain[1][5][5] = 0.131844;
		daq_gain[1][5][6] = 0.150675;
		daq_gain[1][5][7] = 0.17934;
		daq_gain[1][5][8] = 0.14843;
		daq_gain[1][5][9] = 0.17934;
		daq_gain[1][5][10] = 0.1281;
		daq_gain[1][5][11] = 0.145865;
		daq_gain[1][5][12] = 0.128999;
		daq_gain[1][5][13] = 0.0017934;
		daq_gain[1][5][14] = 0.113113;
		daq_gain[1][5][15] = 0.140247;

		daq_gain[1][6][0] = 0.145716;
		daq_gain[1][6][1] = 0.128215;
		daq_gain[1][6][2] = 0.140302;
		daq_gain[1][6][3] = 0.150833;
		daq_gain[1][6][4] = 0.137163;
		daq_gain[1][6][5] = 0.124154;
		daq_gain[1][6][6] = 0.145569;
		daq_gain[1][6][7] = 0.124911;
		daq_gain[1][6][8] = 0.139158;
		daq_gain[1][6][9] = 0.129792;
		daq_gain[1][6][10] = 0.138487;
		daq_gain[1][6][11] = 0.133141;
		daq_gain[1][6][12] = 0.12379;
		daq_gain[1][6][13] = 0.135351;
		daq_gain[1][6][14] = 0.12735;
		daq_gain[1][6][15] = 0.13711;

		daq_gain[1][7][0] = 0.135454;
		daq_gain[1][7][1] = 0.136381;
		daq_gain[1][7][2] = 0.127147;
		daq_gain[1][7][3] = 0.128813;
		daq_gain[1][7][4] = 0.172071;
		daq_gain[1][7][5] = 0.17934;
		daq_gain[1][7][6] = 0.135915;
		daq_gain[1][7][7] = 0.136458;
		daq_gain[1][7][8] = 0.123555;
		daq_gain[1][7][9] = 0.134388;
		daq_gain[1][7][10] = 0.13761;
		daq_gain[1][7][11] = 0.117755;
		daq_gain[1][7][12] = 0.140055;
		daq_gain[1][7][13] = 0.145009;
		daq_gain[1][7][14] = 0.126765;
		daq_gain[1][7][15] = 0.144542;

		daq_gain[1][8][0] = 0.128906;
		daq_gain[1][8][1] = 0.148738;
		daq_gain[1][8][2] = 0.123704;
		daq_gain[1][8][3] = 0.115778;
		daq_gain[1][8][4] = 0.17934;
		daq_gain[1][8][5] = 0.138567;
		daq_gain[1][8][6] = 0.120484;
		daq_gain[1][8][7] = 0.126185;
		daq_gain[1][8][8] = 0.139456;
		daq_gain[1][8][9] = 0.124998;
		daq_gain[1][8][10] = 0.147272;
		daq_gain[1][8][11] = 0.151406;
		daq_gain[1][8][12] = 0.12672;
		daq_gain[1][8][13] = 0.145127;
		daq_gain[1][8][14] = 0.139321;
		daq_gain[1][8][15] = 0.130075;

		daq_gain[1][9][0] = 0.125347;
		daq_gain[1][9][1] = 0.121012;
		daq_gain[1][9][2] = 0.126631;
		daq_gain[1][9][3] = 0.17934;
		daq_gain[1][9][4] = 0.125107;
		daq_gain[1][9][5] = 0.137137;
		daq_gain[1][9][6] = 0.12735;
		daq_gain[1][9][7] = 0.150453;
		daq_gain[1][9][8] = 0.12169;
		daq_gain[1][9][9] = 0.121278;
		daq_gain[1][9][10] = 0.17934;
		daq_gain[1][9][11] = 0.16979;
		daq_gain[1][9][12] = 0.147727;
		daq_gain[1][9][13] = 0.0017934;
		daq_gain[1][9][14] = 0.1446;
		daq_gain[1][9][15] = 0.179296;

		daq_gain[1][10][0] = 0.16907;
		daq_gain[1][10][1] = 0.138889;
		daq_gain[1][10][2] = 0.152371;
		daq_gain[1][10][3] = 0.130122;
		daq_gain[1][10][4] = 0.126967;
		daq_gain[1][10][5] = 0.137294;
		daq_gain[1][10][6] = 0.157282;
		daq_gain[1][10][7] = 0.135198;
		daq_gain[1][10][8] = 0.134312;
		daq_gain[1][10][9] = 0.126407;
		daq_gain[1][10][10] = 0.125282;
		daq_gain[1][10][11] = 0.0017934;
		daq_gain[1][10][12] = 0.123068;
		daq_gain[1][10][13] = 0.135071;
		daq_gain[1][10][14] = 0.15289;
		daq_gain[1][10][15] = 0.17934;

		daq_gain[1][13][0] = 0.163222;
		daq_gain[1][13][1] = 0.177083;
		daq_gain[1][13][2] = 0.138755;
		daq_gain[1][13][3] = 0.17934;
		daq_gain[1][13][4] = 0.165749;
		daq_gain[1][13][5] = 0.0017934;
		daq_gain[1][13][6] = 0.239121;
		daq_gain[1][13][7] = 0.142503;
		daq_gain[1][13][8] = 0.204961;
		daq_gain[1][13][9] = 0.17934;
		daq_gain[1][13][10] = 0.17934;
		daq_gain[1][13][11] = 0.17934;
		daq_gain[1][13][12] = 0.129161;
		daq_gain[1][13][13] = 0.130548;
		daq_gain[1][13][14] = 0.150738;
		daq_gain[1][13][15] = 0.150833;

		daq_gain[1][14][0] = 0.167023;
		daq_gain[1][14][1] = 0.141269;
		daq_gain[1][14][2] = 0.0017934;
		daq_gain[1][14][3] = 0.138193;
		daq_gain[1][14][4] = 0.137478;
		daq_gain[1][14][5] = 0.12526;
		daq_gain[1][14][6] = 0.17934;
		daq_gain[1][14][7] = 0.144659;
		daq_gain[1][14][8] = 0.204961;
		daq_gain[1][14][9] = 0.127057;
		daq_gain[1][14][10] = 0.129161;
		daq_gain[1][14][11] = 0.160699;
		daq_gain[1][14][12] = 0.143875;
		daq_gain[1][14][13] = 0.15394;
		daq_gain[1][14][14] = 0.12271;
		daq_gain[1][14][15] = 0.140494;

		hasLoaded = 1;
	}

}
void FTCalHitEneCorr_factory::Process(const std::shared_ptr<const JEvent> &aEvent) {

	TranslationTable::ChannelInfo m_channel;

	//Get the hits from FADC. Support bot the waveboard hit and the fa250VTPMode7 hit
	auto faHits_waveboard = aEvent->Get<faWaveboardHit>();
	auto faHits_fa250VTPMode7 = aEvent->Get<fa250VTPMode7Hit>();
	std::vector<FTCalHitEneCorr*> allHits;

	for (auto faHit : faHits_waveboard) {

		m_channel = m_tt->getChannelInfo(faHit->m_channel);

		if ((m_channel.det_sys == TranslationTable::FTCAL)) {
			//Convert the waveboard hit. Probably will never be used, unless we will perform FT tests with waveboard.
			//It is used to test the system with data from a waveboard

			//Create a new FTCal Hit Object object
			auto ftCalHit = new FTCalHitEneCorr();

			//Assign the channel
			//Since this comes from the TT, it is still sector-layer-component)
			ftCalHit->m_channel = *(m_channel.FTCAL);

			//Here set iX and iY
			//(see https://github.com/JeffersonLab/clas12-offline-software/blob/development/reconstruction/ft/src/main/java/org/jlab/rec/ft/cal/FTCALHit.java#L40-L41)
			ftCalHit->m_channel.iY = (ftCalHit->m_channel.component / 22) + 1;
			ftCalHit->m_channel.iX = (ftCalHit->m_channel.component + 1) - (ftCalHit->m_channel.iY - 1) * 22;

			//Assign the time
			ftCalHit->setHitTime(4 * faHit->m_time.count());

			//Assign the energy
			//TODO: eventually apply another correction, here I just take the energy as provided by VTP
			ftCalHit->setHitEnergy(faHit->m_charge);

			//Assign the position
			ftCalHit->setHitX((ftCalHit->m_channel.iX - CRYS_DELTA) * CRYS_WIDTH);
			ftCalHit->setHitY((ftCalHit->m_channel.iY - CRYS_DELTA) * CRYS_WIDTH);
			ftCalHit->setHitZ(CRYS_ZPOS);

			allHits.push_back(ftCalHit);

//			mData.push_back(ftCalHit);
		}
	}

	//Here is the important part - converting the faHit from VTPMode7 to ftCalHit
	for (auto faHit : faHits_fa250VTPMode7) {
		m_channel = m_tt->getChannelInfo(faHit->m_channel);
		if ((m_channel.det_sys == TranslationTable::FTCAL)) {

			//Create a new FTCal Hit Object object
			auto ftCalHit = new FTCalHitEneCorr();

			//Assign the channel
			//Since this comes from the TT, it is still sector-layer-component)
			ftCalHit->m_channel = *(m_channel.FTCAL);

			//Here set iX and iY
			//(see https://github.com/JeffersonLab/clas12-offline-software/blob/development/reconstruction/ft/src/main/java/org/jlab/rec/ft/cal/FTCALHit.java#L40-L41)
			ftCalHit->m_channel.iY = (ftCalHit->m_channel.component / 22) + 1;
			ftCalHit->m_channel.iX = (ftCalHit->m_channel.component + 1) - (ftCalHit->m_channel.iY - 1) * 22;

			//Since the Time Walk correction was verified, I apply it. Assign corrected time to FTCalHit (timewalk + crates delay)
			double timeWalkCorrection = -(tw[ftCalHit->m_channel.component][0] / (tw[ftCalHit->m_channel.component][1] + tw[ftCalHit->m_channel.component][2] * sqrt(faHit->m_charge))
					+ tw[ftCalHit->m_channel.component][3]);

			if (ftCalHit->m_channel.iX >= 12 || ftCalHit->m_channel.component == 224 || ftCalHit->m_channel.component == 242 || ftCalHit->m_channel.component == 360
					|| ftCalHit->m_channel.component == 445 || ftCalHit->m_channel.component == 96 || ftCalHit->m_channel.component == 142) {
				ftCalHit->setHitTime(4 * faHit->m_time.count() - 19.5 + timeWalkCorrection);
			} else {
				ftCalHit->setHitTime(4 * faHit->m_time.count() + timeWalkCorrection);
			}
			ftCalHit->setTimeWalkCorrection(timeWalkCorrection);

			//			ftCalHit->setHitTime(4 * faHit->m_time.count());

			//Assign the energy
			ftCalHit->setHitEnergyRaw(faHit->m_charge);

			//Assign the position
			ftCalHit->setHitX((ftCalHit->m_channel.iX - CRYS_DELTA) * CRYS_WIDTH);
			ftCalHit->setHitY((ftCalHit->m_channel.iY - CRYS_DELTA) * CRYS_WIDTH);
			ftCalHit->setHitZ(CRYS_ZPOS);

			//Energy correction

			//VTP computes energy = charge * constant, where charge = sum_of_samples
			int theCrate = 0;
			if (faHit->m_channel.crate == 71)
				theCrate = 1;

			auto charge = faHit->m_charge / daq_gain[theCrate][faHit->m_channel.slot][faHit->m_channel.channel];
//			cout << endl << endl << "Hit component: " << ftCalHit->m_channel.component << " X = " << (ftCalHit->m_channel.component / 22) + 1. << "; Y = "
//					<< (ftCalHit->m_channel.component + 1) - (ftCalHit->m_channel.iY - 1.) * 22 << endl;
//			cout << "Original charge " << faHit->m_charge << endl;
//			cout << "daq_gain " << daq_gain[theCrate][faHit->m_channel.slot][faHit->m_channel.channel] << endl;
//			cout << "charge = faHit->m_charge / daq_gain  " << charge << endl;

			//code in https://github.com/JeffersonLab/clas12-offline-software/blob/development/reconstruction/ft/src/main/java/org/jlab/rec/ft/cal/FTCALHit.java
			//chargeNew = charge * fadc_to_charge, where fadc_to_charge = 0.039064
			//ene = calib * cosmics_ene / cosmics_charge, where cosmics_ene = 15.3

			static auto fadc_to_charge = 0.039064;
			static auto cosmic_ene = 15.3;

			charge = charge * fadc_to_charge;
//			cout << "fadc_to_charge " << fadc_to_charge << endl;
//			cout << "charge = charge * fadc_to_charge; " << charge << endl;
//			cout << "mips_charge " << mips_charge[ftCalHit->m_channel.component] << endl;
//			cout << "cosmic_ene " << cosmic_ene << endl;
			charge = charge * cosmic_ene / mips_charge[ftCalHit->m_channel.component];
//			cout << "charge = charge * cosmic_ene / mips_charge " << charge << endl;

			ftCalHit->setHitEnergy(charge);
//			cin.get();

			allHits.push_back(ftCalHit);

//			mData.push_back(ftCalHit);
		}
	}
	//If you want all data, you need to comment this loop and to uncomment the //mData.push_back in the previous loop.
	for (int i = 0; i < allHits.size(); i++) {
		bool flag = false;
		for (int j = 0; j < allHits.size(); j++) {
			if (i != j && allHits[i]->getHitIX() == allHits[j]->getHitIX() && allHits[i]->getHitIY() == allHits[j]->getHitIY() && allHits[i]->getHitTime() - allHits[j]->getHitTime() < 160
					&& allHits[i]->getHitTime() - allHits[j]->getHitTime() > 0 && allHits[i]->getHitEnergy() - allHits[j]->getHitEnergy() < 0) {
				flag = true;
				break;
			}
		}
		if (flag == true) {
			delete allHits[i];
		} else {
			mData.push_back(allHits[i]);
		}
	}
}

